{% extends "layout.html" %}
{% load i18n static %}

{% block breadcrumb %}
  <li><a href="{% url 'partnerships:partnerships_list' %}" id="lnk_partnerships">{% trans 'partnerships' %}</a></li>
  <li class="active">{{ partnership }}</li>
{% endblock %}

{% block style %}
  <link rel="stylesheet" href="{% static "partnerships/partnerships.css" %}">
{% endblock %}

{% block content %}
  <div class="page-header">
    <h1>{{ partnership }}</h1>
  </div>

  <div class="panel panel-default">
    <div class="panel-body">
      <div class="row">
        <div class="col-sm-12">
          <a href="{% url 'partnerships:partnerships_list' %}">{% trans 'back_to_list' %}</a>
        </div>
      </div>
      
      <!-- Partenariat -->
      <h2>{% trans "partnership_between" %}</h2>
      <div class="row">
        <div class="col-sm-12">
          <p>
            <em>
              {% blocktrans with created=partnership.created|date:"SHORT_DATE_FORMAT" author=partnership.author modified=partnership.modified|date:"SHORT_DATE_FORMAT" %}created_{{ created }}_by_{{ author }}_modified_{{ modified }}{% endblocktrans %}
            </em>
          </p>
          <i>{% if partnership.is_valid %}{% trans "valid" %}{% else %}{% trans "not_valid" %}{% endif %}</i>
        </div>
      </div>
      {% if partnership.partner or partnership.partner_entity %}
        <div class="row">
          <div class="col-sm-12">
            {% if partnership.partner %}<strong>{{ partnership.partner }}</strong>{% endif %}
            {% if partnership.partner and partnership.partner_entity %} &gt; {% endif %}
            {% if partnership.partner_entity %}<strong>{{ partnership.partner_entity }}</strong>{% endif %}
          </div>
        </div>
      {% endif %}
      <div class="row">
        <div class="col-sm-12">
          <strong>{% if partnership.ucl_university %}{{ partnership.ucl_university.acronym }}{% else %}{% trans "no_university" %}{% endif %}</strong>
          {% if partnership.ucl_university_labo %}&gt; <strong>{{ partnership.ucl_university_labo }} lab</strong>{% endif %}
          {% if partnership.university_offers_count > 0 %} &gt; <strong>{% if partnership.university_offers_count == 1 %}{{ partnership.university_offers.all.0 }}{% else %}{{ partnership.university_offers_count }} {% trans "offers" %}{% endif %}</strong>{% endif %}
        </div>
      </div>
      {% if partnership.start_date or partnership.end_date %}<div class="row"><div class="col-sm-12">{{ partnership.start_date|default_if_none:"" }} &gt; {{ partnership.end_date|default_if_none:"" }}</div></div>{% endif %}

      {% if partnership.years.all %}
      <table class="table">
        <thead>
          <tr>
            <th></th>
            <th>{% trans "mobility_type" %}</th>
            <th>{% trans "partnership_type" %}</th>
          </tr>
        </thead>
        <tbody>
          {% for partnership_year in partnership.years.all %}
          <tr>
            <th>{{ partnership_year.academic_year }}</th>
            <td>{{ partnership_year.mobility_type }}</td>
            <td>{{ partnership_year.get_partnership_type_display }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% endif %}

      {% if partnership.comment is not None %}
        <div class="row">
          <div class="col-sm-12">
            {{ partnership.comment }}
          </div>
        </div>
      {% endif %}
      
      <!-- Contacts -->
      {% if partnership.contacts.all %}
        <h2>{% trans "contacts" %}</h2>
        <div class="row">
          <div class="col-sm-12 col-md-6">
            {% for contact in partnership.contacts.all %}
              {% include "partnerships/includes/contact.html" with contact=contact %}
            {% endfor %}
          </div>
        </div>
      {% endif %}

      <!-- Accords -->
      <h2>{% trans "agreements" %}</h2>
      {% for agreement in partnership.agreements.all %}
      <div class="row">
        <div class="col-sm-12 col-md-6">
          <div class="row">
            <div class="col-sm-5">
              {{ agreement.start_academic_year }} > {{ agreement.end_academic_year }}
            </div>
            <div class="col-sm-7">
              <strong>{{ agreement.get_status_display }}</strong>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <p>{{ agreement.note }}</p>
            </div>
          </div>
        </div>
        <div class="col-sm-12 col-md-6">
          {% include "partnerships/includes/media_detail.html" with media=agreement.media %}
        </div>
      </div>
      {% empty %}
      <div class="row">
        <div class="col-sm-12">{% trans "no_agreement_yet" %}</div>
      </div>
      {% endfor %}
      
      <!-- Tags -->
      <h2>{% trans "tags" %}</h2>
      {% if partnership.tags.all %}
        <div class="row">
          <div class="col-sm-12">
            <ul class="tags-list">
              {% for tag in partnership.tags.all %}
                <li>{{ tag }}</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
{% endblock %}
